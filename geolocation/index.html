<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
	<meta name="author" content="The CSS Ninja" />
	<meta name="keywords" content="CSS, CSS Ninja, The CSS Ninja, Web, xhtml, html, browsers, JavaScript, cascading style sheets" />
	<meta name="description" content="Location aware web app utilising the Geolocation API to get a users location in the browser" />
	<meta name="robots" content="all" />
	<meta name="copyright" content="The CSS Ninja" />
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0">
	
	<link rel="stylesheet" type="text/css" href="_styles.css" media="screen" />
	
	<title>Geolocation in the browser | The CSS Ninja</title>

</head>
<body>
	

	<script type="text/javascript">

				currentLatLng, cacheLatLng, failedLatLng, updatedLatLng, locationMarker, coordsListener,
			
			function mapSetup() {
				if(navigator.geolocation) {
					// Get current position
					navigator.geolocation.getCurrentPosition(createMap, handleError); // Request live position
					
				} else {
					loaderContainer.getElementsByTagName("p")[0].textContent = "Browser does not support geolocation object";
					window.setTimeout(failedError, 1000);
				}
			};
			
			// Update handlers
			function createMap(position){
alert(position.coords.latitude); 
alert(position.coords.longitude);
			};
			
			// Error handlers
			function handleError(error){
				if(error.code === 1) {
					//Location services is either disabled or you denied access to your position
					failedError();
				} else {
					//Current location could not be determined, falling back to last known within 10 minutes
					navigator.geolocation.getCurrentPosition(cacheLocation, cacheError, {maximumAge:600000, timeout:0});
				}
				
				loaderContainer.style.display = "none";
			};
			function cacheError(error){
				//Couldn't get current nor no more than 10 min old cache location, fallback to any cache
				navigator.geolocation.getCurrentPosition(cacheLocation, failedError, {maximumAge:"Infinite", timeout:0});
			};
			function failedError(error){
				//Failed to find any location, fallback to Apple HQ
				alert("failed");
			};
			
			mapSetup();

	</script>
	
</body>
</html>
